{% extends "mailservices/base.html" %}

{% block title %}Список gbctv{% endblock %}

{% block content %}
<h2>Список рассылок</h2>

{% if object_list %}
  <table class="table table-striped table-hover">
    <thead class="table-light">
      <tr>
          <th>Дата и время начала отправки</th>
          <th>Дата и время конца отправки</th>
          <th>Статус рассылки</th>
          <th>Сообщение для рассылки</th>
          <th>Пользователи для рассылки</th>
      </tr>
    </thead>
    <tbody>
      {% for sending in object_list %}
        <tr>
            <td>{{ sending.start_datetime }}</td>
            <td>{{ sending.end_datetime }}</td>
            <td>{{ sending.get_status_display }}</td>
            <td>{{ sending.message }}</td>
            <td>
            {% if sending.recipients.all %}
              {% for client in sending.recipients.all %}
                {{ client.full_name }}{% if not forloop.last %}, {% endif %}
              {% endfor %}
            {% else %}
              <span class="text-muted">—</span>
            {% endif %}
          <td>
            <a href="#">Просмотр</a>
            <a href="#">Изменить</a>
            <a href="{% url 'mailservices:sending_delete' sending.pk %}"">Удалить</a>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <div class="alert alert-info">Нет рассылок.</div>
{% endif %}

<div class="mt-3">
  <a href="#" class="btn btn-success">Создать новую рассылку</a>
</div>

{% endblock %}